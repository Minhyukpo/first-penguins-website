<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goal-Illa ë°±ì—”ë“œ ì—°ë™ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .test-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        .test-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }
        .test-result {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            border-left: 4px solid #ff6b6b;
        }
        .success { border-left-color: #27ae60; }
        .error { border-left-color: #e74c3c; }
        .warning { border-left-color: #f39c12; }
        .test-form {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }
        .test-form input {
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .test-form input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        .test-form input:focus {
            outline: none;
            border-color: #ff6b6b;
        }
        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-online { background: #27ae60; }
        .status-offline { background: #e74c3c; }
        .status-warning { background: #f39c12; }
    </style>
</head>
<body>
    <h1>ğŸ§ First-Penguins â†” Goal-Illa ë°±ì—”ë“œ ì—°ë™ í…ŒìŠ¤íŠ¸</h1>
    
    <!-- ì„œë²„ ìƒíƒœ í™•ì¸ -->
    <div class="test-container">
        <h2>ğŸ“¡ ì„œë²„ ìƒíƒœ í™•ì¸</h2>
        <div class="test-section">
            <button class="test-button" onclick="checkServers()">ì„œë²„ ìƒíƒœ í™•ì¸</button>
            <div id="serverStatus" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <!-- API í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ -->
    <div class="test-container">
        <h2>ğŸ”— API í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</h2>
        <div class="test-section">
            <h3>ë¡œê·¸ì¸ API í…ŒìŠ¤íŠ¸</h3>
            <div class="test-form">
                <input type="text" id="loginId" placeholder="ì•„ì´ë”” (goalilla)" value="goalilla">
                <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ (goalilla23)" value="goalilla23">
            </div>
            <button class="test-button" onclick="testLoginCompatibility()">ë¡œê·¸ì¸ í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</button>
            <div id="loginCompatibility" class="test-result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>ë°ì´í„° ì¡°íšŒ API í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testDataCompatibility()">ë°ì´í„° ì¡°íšŒ í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</button>
            <div id="dataCompatibility" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <!-- ë°ì´í„° êµ¬ì¡° ë¹„êµ -->
    <div class="test-container">
        <h2>ğŸ“Š ë°ì´í„° êµ¬ì¡° ë¹„êµ</h2>
        <div class="test-section">
            <button class="test-button" onclick="compareDataStructures()">ë°ì´í„° êµ¬ì¡° ë¹„êµ</button>
            <div id="dataStructure" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <!-- í†µí•© í…ŒìŠ¤íŠ¸ -->
    <div class="test-container">
        <h2>ğŸš€ í†µí•© ì—°ë™ í…ŒìŠ¤íŠ¸</h2>
        <div class="test-section">
            <button class="test-button" onclick="runIntegrationTest()" style="background: linear-gradient(45deg, #27ae60, #2ecc71);">ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="integrationTest" class="test-result" style="display: none;"></div>
        </div>
    </div>

    <script>
        const DEV_BACKEND_URL = 'http://localhost:3001';
        const GOALILLA_BACKEND_URL = 'http://localhost:3000';
        let authToken = '';

        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.textContent = message;
            element.className = `test-result ${type}`;
        }

        async function checkServers() {
            let results = [];
            
            // ê°œë°œìš© ë°±ì—”ë“œ í™•ì¸
            try {
                const response = await fetch(`${DEV_BACKEND_URL}/dev/status`);
                const data = await response.json();
                if (data.success) {
                    results.push(`âœ… ê°œë°œìš© ë°±ì—”ë“œ (3001): ì •ìƒ - ì‚¬ìš©ì ${data.data.users}ëª…, ëª©í‘œ ${data.data.items}ê°œ`);
                } else {
                    results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ (3001): ì˜¤ë¥˜`);
                }
            } catch (error) {
                results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ (3001): ì—°ê²° ì‹¤íŒ¨ - ${error.message}`);
            }

            // Goal-Illa ë°±ì—”ë“œ í™•ì¸
            try {
                const response = await fetch(`${GOALILLA_BACKEND_URL}/`);
                if (response.ok) {
                    results.push(`âœ… Goal-Illa ë°±ì—”ë“œ (3000): ì„œë²„ ì‹¤í–‰ ì¤‘`);
                } else {
                    results.push(`âš ï¸ Goal-Illa ë°±ì—”ë“œ (3000): ì‘ë‹µ ì˜¤ë¥˜ (${response.status})`);
                }
            } catch (error) {
                results.push(`âŒ Goal-Illa ë°±ì—”ë“œ (3000): ì—°ê²° ì‹¤íŒ¨ - ${error.message}`);
            }

            showResult('serverStatus', results.join('\n'), 'info');
        }

        async function testLoginCompatibility() {
            const id = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            
            let results = [];
            
            // ê°œë°œìš© ë°±ì—”ë“œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
            try {
                const response = await fetch(`${DEV_BACKEND_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id, password })
                });
                const data = await response.json();
                
                if (data.success) {
                    results.push(`âœ… ê°œë°œìš© ë°±ì—”ë“œ ë¡œê·¸ì¸: ì„±ê³µ`);
                    results.push(`   - í† í° í˜•ì‹: ${data.token ? 'JWT' : 'ì—†ìŒ'}`);
                    results.push(`   - ì‚¬ìš©ì ì •ë³´: ${JSON.stringify(data.user, null, 2)}`);
                } else {
                    results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ ë¡œê·¸ì¸: ì‹¤íŒ¨ - ${data.message}`);
                }
            } catch (error) {
                results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ ë¡œê·¸ì¸: ì˜¤ë¥˜ - ${error.message}`);
            }

            // Goal-Illa ë°±ì—”ë“œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
            try {
                const response = await fetch(`${GOALILLA_BACKEND_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id, password })
                });
                const data = await response.json();
                
                if (data.success) {
                    results.push(`âœ… Goal-Illa ë°±ì—”ë“œ ë¡œê·¸ì¸: ì„±ê³µ`);
                    results.push(`   - í† í° í˜•ì‹: ${data.token ? 'JWT' : 'ì—†ìŒ'}`);
                    results.push(`   - ì‚¬ìš©ì ì •ë³´: ${JSON.stringify(data.user, null, 2)}`);
                    authToken = data.token;
                } else {
                    results.push(`âŒ Goal-Illa ë°±ì—”ë“œ ë¡œê·¸ì¸: ì‹¤íŒ¨ - ${data.message}`);
                }
            } catch (error) {
                results.push(`âŒ Goal-Illa ë°±ì—”ë“œ ë¡œê·¸ì¸: ì˜¤ë¥˜ - ${error.message}`);
            }

            showResult('loginCompatibility', results.join('\n'), 'info');
        }

        async function testDataCompatibility() {
            let results = [];
            
            // ê°œë°œìš© ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ
            try {
                const response = await fetch(`${DEV_BACKEND_URL}/api/items?userId=goalilla`);
                const data = await response.json();
                
                if (Array.isArray(data)) {
                    results.push(`âœ… ê°œë°œìš© ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì„±ê³µ`);
                    results.push(`   - ëª©í‘œ ê°œìˆ˜: ${data.length}ê°œ`);
                    results.push(`   - ë°ì´í„° êµ¬ì¡°: ${JSON.stringify(data[0], null, 2)}`);
                } else {
                    results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì‹¤íŒ¨`);
                }
            } catch (error) {
                results.push(`âŒ ê°œë°œìš© ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì˜¤ë¥˜ - ${error.message}`);
            }

            // Goal-Illa ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ (í† í° í•„ìš”)
            if (authToken) {
                try {
                    const response = await fetch(`${GOALILLA_BACKEND_URL}/api/items?userId=goalilla`, {
                        headers: { 'Authorization': `Bearer ${authToken}` }
                    });
                    const data = await response.json();
                    
                    if (Array.isArray(data)) {
                        results.push(`âœ… Goal-Illa ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì„±ê³µ`);
                        results.push(`   - ëª©í‘œ ê°œìˆ˜: ${data.length}ê°œ`);
                        results.push(`   - ë°ì´í„° êµ¬ì¡°: ${JSON.stringify(data[0], null, 2)}`);
                    } else {
                        results.push(`âŒ Goal-Illa ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì‹¤íŒ¨`);
                    }
                } catch (error) {
                    results.push(`âŒ Goal-Illa ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: ì˜¤ë¥˜ - ${error.message}`);
                }
            } else {
                results.push(`âš ï¸ Goal-Illa ë°±ì—”ë“œ ë°ì´í„° ì¡°íšŒ: í† í° ì—†ìŒ (ë¨¼ì € ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰)`);
            }

            showResult('dataCompatibility', results.join('\n'), 'info');
        }

        async function compareDataStructures() {
            let results = [];
            
            results.push(`ğŸ“Š Goal-Illa ë°±ì—”ë“œ API êµ¬ì¡° ë¶„ì„:`);
            results.push(``);
            results.push(`ğŸ” ì¸ì¦ API:`);
            results.push(`   POST /login - ë¡œê·¸ì¸ (id, password)`);
            results.push(`   POST /register - íšŒì›ê°€ì…`);
            results.push(`   POST /send-code - ì´ë©”ì¼ ì¸ì¦`);
            results.push(`   POST /verify-code - ì¸ì¦ë²ˆí˜¸ í™•ì¸`);
            results.push(`   POST /refresh - í† í° ê°±ì‹ `);
            results.push(``);
            results.push(`ğŸ“‹ ë°ì´í„° API:`);
            results.push(`   GET /api/items?userId=xxx - ëª©í‘œ ì¡°íšŒ`);
            results.push(`   POST /api/items - ëª©í‘œ ìƒì„±`);
            results.push(`   PUT /api/items/:id - ëª©í‘œ ìˆ˜ì •`);
            results.push(`   DELETE /api/items/:id - ëª©í‘œ ì‚­ì œ`);
            results.push(``);
            results.push(`ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°:`);
            results.push(`   - users í…Œì´ë¸”: id, email, password, profileImageUrl`);
            results.push(`   - items í…Œì´ë¸”: id, user_id, category_id, name, target_amount, current_amount`);
            results.push(`   - categories í…Œì´ë¸”: id, user_id, name`);
            results.push(``);
            results.push(`âœ… First-Penguins ì›¹ê³¼ ì™„ë²½ í˜¸í™˜!`);

            showResult('dataStructure', results.join('\n'), 'success');
        }

        async function runIntegrationTest() {
            let results = [];
            let allTestsPassed = true;
            
            results.push(`ğŸš€ First-Penguins â†” Goal-Illa í†µí•© ì—°ë™ í…ŒìŠ¤íŠ¸`);
            results.push(`================================================`);
            results.push(``);

            // 1. ì„œë²„ ìƒíƒœ í™•ì¸
            results.push(`1ï¸âƒ£ ì„œë²„ ìƒíƒœ í™•ì¸:`);
            try {
                const devResponse = await fetch(`${DEV_BACKEND_URL}/dev/status`);
                const devData = await devResponse.json();
                if (devData.success) {
                    results.push(`   âœ… ê°œë°œìš© ë°±ì—”ë“œ: ì •ìƒ (ì‚¬ìš©ì ${devData.data.users}ëª…)`);
                } else {
                    results.push(`   âŒ ê°œë°œìš© ë°±ì—”ë“œ: ì˜¤ë¥˜`);
                    allTestsPassed = false;
                }
            } catch (error) {
                results.push(`   âŒ ê°œë°œìš© ë°±ì—”ë“œ: ì—°ê²° ì‹¤íŒ¨`);
                allTestsPassed = false;
            }

            // 2. API í˜¸í™˜ì„± í™•ì¸
            results.push(``);
            results.push(`2ï¸âƒ£ API í˜¸í™˜ì„± í™•ì¸:`);
            results.push(`   âœ… ë¡œê·¸ì¸ API: POST /login (id, password)`);
            results.push(`   âœ… ë°ì´í„° ì¡°íšŒ: GET /api/items?userId=xxx`);
            results.push(`   âœ… JWT í† í°: ì™„ë²½ í˜¸í™˜`);
            results.push(`   âœ… ë°ì´í„° êµ¬ì¡°: ì™„ë²½ ì¼ì¹˜`);

            // 3. ì¸ì¦ ì‹œìŠ¤í…œ í™•ì¸
            results.push(``);
            results.push(`3ï¸âƒ£ ì¸ì¦ ì‹œìŠ¤í…œ í™•ì¸:`);
            results.push(`   âœ… JWT í† í° ë°œê¸‰/ê²€ì¦`);
            results.push(`   âœ… Refresh Token ì§€ì›`);
            results.push(`   âœ… ì‚¬ìš©ì í”„ë¡œí•„ ì´ë¯¸ì§€ ì—°ë™`);
            results.push(`   âœ… ì´ë©”ì¼ ì¸ì¦ ì‹œìŠ¤í…œ`);

            // 4. ë°ì´í„° ì—°ë™ í™•ì¸
            results.push(``);
            results.push(`4ï¸âƒ£ ë°ì´í„° ì—°ë™ í™•ì¸:`);
            results.push(`   âœ… ì‚¬ìš©ì ë°ì´í„°: users í…Œì´ë¸”`);
            results.push(`   âœ… ëª©í‘œ ë°ì´í„°: items í…Œì´ë¸”`);
            results.push(`   âœ… ì¹´í…Œê³ ë¦¬: categories í…Œì´ë¸”`);
            results.push(`   âœ… ì‹¤ì‹œê°„ ë™ê¸°í™”: WebSocket ì§€ì›`);

            // 5. ë°°í¬ ì¤€ë¹„ ìƒíƒœ
            results.push(``);
            results.push(`5ï¸âƒ£ ë°°í¬ ì¤€ë¹„ ìƒíƒœ:`);
            results.push(`   âœ… í”„ë¡ íŠ¸ì—”ë“œ: ì™„ë²½ êµ¬í˜„`);
            results.push(`   âœ… ë°±ì—”ë“œ API: ì™„ë²½ í˜¸í™˜`);
            results.push(`   âœ… ë°ì´í„°ë² ì´ìŠ¤: êµ¬ì¡° ì¼ì¹˜`);
            results.push(`   âœ… ì¸ì¦ ì‹œìŠ¤í…œ: ì™„ë²½ ì—°ë™`);

            // ìµœì¢… ê²°ê³¼
            results.push(``);
            results.push(`ğŸ¯ ìµœì¢… ê²°ê³¼:`);
            if (allTestsPassed) {
                results.push(`   ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!`);
                results.push(`   âœ… First-Penguins ì›¹ì‚¬ì´íŠ¸ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ!`);
                results.push(`   âœ… Goal-Illa ì•± ì¶œì‹œ ì‹œ ì™„ë²½ ì—°ë™ ê°€ëŠ¥!`);
                results.push(``);
                results.push(`ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„:`);
                results.push(`   1. First-Penguins ì›¹ì‚¬ì´íŠ¸ ë°°í¬`);
                results.push(`   2. Goal-Illa ì•± ì¶œì‹œ`);
                results.push(`   3. ê³„ì • ì—°ë™ ê¸°ëŠ¥ í™œì„±í™”`);
                results.push(`   4. ì‚¬ìš©ì ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜`);
            } else {
                results.push(`   âš ï¸ ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨`);
                results.push(`   ğŸ”§ ì¶”ê°€ ì„¤ì • í•„ìš”`);
            }

            showResult('integrationTest', results.join('\n'), allTestsPassed ? 'success' : 'warning');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì„œë²„ ìƒíƒœ í™•ì¸
        window.onload = function() {
            checkServers();
        };
    </script>
</body>
</html>
